<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è­·ç†ç«™ AI æ’ç­ç³»çµ±</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¥</text></svg>">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    
    <style>
        /* è‡ªè¨‚æ¨£å¼ï¼šè®“è¡¨æ ¼æ¨™é ­å›ºå®šï¼Œæ–¹ä¾¿é•·åå–®é–±è®€ */
        .table-responsive {
            max-height: 70vh;
            overflow-y: auto;
        }
        thead th {
            position: sticky;
            top: 0;
            background-color: #f8f9fa;
            z-index: 1;
        }
        /* é€±æœ«é¡è‰²å€éš” */
        .weekend {
            background-color: #fff3cd;
        }
    </style>
</head>
<body>

    <div id="loading-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffffff; z-index: 9999; display: flex; justify-content: center; align-items: center; flex-direction: column;">
        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3 text-secondary fw-bold">ç³»çµ±å•Ÿå‹•ä¸­...</p>
    </div>

    <div id="app">
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <div class="container-fluid">
                <a class="navbar-brand" href="#"><i class="bi bi-hospital"></i> è­·ç†ç«™ AI æ’ç­ç³»çµ±</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="#">ä¸»æ§å°</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">äººå“¡ç®¡ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Google Sheet é€£çµ</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="container mt-4" id="main-view">
            <div class="row align-items-center mb-4">
                <div class="col-md-3">
                    <label for="scheduleMonth" class="form-label fw-bold">æ’ç­æœˆä»½</label>
                    <input type="month" class="form-control" id="scheduleMonth" value="2025-12">
                </div>
                
                <div class="col-md-9 d-flex justify-content-end align-items-end gap-2">
                    <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#settingsModal">
                        <i class="bi bi-gear-fill"></i> æ’ç­è¦å‰‡è¨­å®š
                    </button>
                    
                    <button class="btn btn-outline-success">
                        <i class="bi bi-cloud-arrow-down"></i> è®€å–äººå“¡/é å‡
                    </button>
                    
                    <button class="btn btn-primary">
                        <i class="bi bi-magic"></i> é–‹å§‹ AI æ’ç­
                    </button>
                    
                    <button class="btn btn-warning text-dark">
                        <i class="bi bi-file-earmark-spreadsheet"></i> åŒ¯å‡ºè‡³ Excel
                    </button>
                </div>
            </div>

            <div class="card shadow-sm">
                <div class="card-header bg-light">
                    <i class="bi bi-calendar3"></i> ç­è¡¨é è¦½
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover text-center mb-0 align-middle">
                            <thead class="table-light">
                                <tr>
                                    <th style="width: 100px;">å§“å / æ—¥æœŸ</th>
                                    <th>1<br>ä¸€</th>
                                    <th>2<br>äºŒ</th>
                                    <th>3<br>ä¸‰</th>
                                    <th>4<br>å››</th>
                                    <th>5<br>äº”</th>
                                    <th class="weekend text-danger">6<br>å…­</th>
                                    <th class="weekend text-danger">7<br>æ—¥</th>
                                    <th>...</th>
                                </tr>
                            </thead>
                            <tbody id="scheduleTableBody">
                                <tr>
                                    <td colspan="9" class="text-muted py-5">
                                        å°šæœªè¼‰å…¥è³‡æ–™ï¼Œè«‹é»æ“Šã€Œè®€å–äººå“¡ã€æˆ–ã€Œé–‹å§‹ AI æ’ç­ã€
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="settingsModalLabel">æ’ç­è¦å‰‡åƒæ•¸è¨­å®š</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="rulesForm">
              <h6 class="border-bottom pb-2 mb-3 text-primary"><i class="bi bi-people-fill"></i> æ¯æ—¥äººåŠ›ä½é™ (Min Staff)</h6>
              <div class="row mb-3">
                <div class="col">
                  <label class="form-label small">ç™½ç­ (D)</label>
                  <input type="number" class="form-control" id="minStaffD" value="5">
                </div>
                <div class="col">
                  <label class="form-label small">å°å¤œ (E)</label>
                  <input type="number" class="form-control" id="minStaffE" value="3">
                </div>
                <div class="col">
                  <label class="form-label small">å¤§å¤œ (N)</label>
                  <input type="number" class="form-control" id="minStaffN" value="2">
                </div>
              </div>

              <h6 class="border-bottom pb-2 mb-3 mt-4 text-primary"><i class="bi bi-exclamation-triangle-fill"></i> ç­åˆ¥é™åˆ¶ (Constraints)</h6>
              <div class="mb-2 form-check form-switch">
                <input class="form-check-input" type="checkbox" id="avoidNtoD" checked>
                <label class="form-check-label" for="avoidNtoD">ç¦æ­¢ å¤§å¤œ(N) æ¥ ç™½ç­(D)</label>
              </div>
              <div class="mb-2 form-check form-switch">
                <input class="form-check-input" type="checkbox" id="avoidEtoD" checked>
                <label class="form-check-label" for="avoidEtoD">ç¦æ­¢ å°å¤œ(E) æ¥ ç™½ç­(D)</label>
              </div>
              
              <div class="mt-3">
                 <label class="form-label small">æœ€å¤§é€£çºŒä¸Šç­å¤©æ•¸</label>
                 <input type="number" class="form-control" id="maxConsecutiveDays" value="6">
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
            <button type="button" class="btn btn-primary" onclick="saveRules()">å„²å­˜ä¸¦å¥—ç”¨</button>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="./js/app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // --- 1. å…¨åŸŸè®Šæ•¸ï¼šå„²å­˜ç›®å‰çš„è¨­å®š ---
        let currentRules = {
          minStaff: { D: 5, E: 3, N: 2 },
          constraints: {
            noNtoD: true,
            noEtoD: true,
            maxWorkDays: 6
          }
        };

        // --- 2. é é¢è¼‰å…¥æ™‚åŸ·è¡Œ ---
        document.addEventListener('DOMContentLoaded', function() {
            // æ³¨æ„ï¼šå› ç‚ºåŠ å…¥äº† app.js æ¨¡çµ„åŒ–è¼‰å…¥ï¼Œé€™è£¡çš„ Console å¯èƒ½æœƒæ¯” app.js æ™šæˆ–æ—©åŸ·è¡Œ
            // å¯¦éš›é‚è¼¯å»ºè­°ç§»åˆ° app.js å…§éƒ¨çµ±ä¸€ç®¡ç†
            console.log("DOM Ready.");
        });

        // --- 3. å„²å­˜è¨­å®šçš„å‡½å¼ ---
        function saveRules() {
            // æŠ“å– DOM å…ƒç´ çš„å€¼
            const minD = parseInt(document.getElementById('minStaffD').value) || 0;
            const minE = parseInt(document.getElementById('minStaffE').value) || 0;
            const minN = parseInt(document.getElementById('minStaffN').value) || 0;
            
            const noNtoD = document.getElementById('avoidNtoD').checked;
            const noEtoD = document.getElementById('avoidEtoD').checked;
            const maxDays = parseInt(document.getElementById('maxConsecutiveDays').value) || 7;

            // æ›´æ–°å…¨åŸŸè®Šæ•¸ç‰©ä»¶
            currentRules = {
                minStaff: { D: minD, E: minE, N: minN },
                constraints: {
                noNtoD: noNtoD,
                noEtoD: noEtoD,
                maxWorkDays: maxDays
                }
            };

            console.log("è¦å‰‡å·²æ›´æ–°:", currentRules);
            
            // é—œé–‰ Modal
            const modalEl = document.getElementById('settingsModal');
            const modal = bootstrap.Modal.getInstance(modalEl); 
            modal.hide();

            // ç°¡å–®çš„å›é¥‹
            alert(`è¨­å®šå·²å„²å­˜ï¼\nç›®å‰äººåŠ›éœ€æ±‚ï¼šD=${minD}, E=${minE}, N=${minN}`);
        }
    </script>
</body>
</html>
